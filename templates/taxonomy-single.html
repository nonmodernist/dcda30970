{% extends "_base.html" %}

{% block title %}{{ taxonomy.name | title }}: {{ term.name }} | {{ config.title }}{% endblock %}

{% block content %}
<div class="magazine-layout">
    <!-- ARCHIVE HEADER -->
    <div class="archive-header">
        <h1 class="archive-title">
            {{ taxonomy.name | title }}: {{ term.name }}
        </h1>
        
        <div class="archive-description">
            Exploring posts about {{ term.name }} and its connections to digital infrastructure and climate crisis.
        </div>
    </div>
    
    <!-- ARCHIVE CONTENT -->
    <div class="main-content">
        <div class="blog-list">
            {% for page in term.pages %}
                <article class="blog-card {% if page.extra.author == 'Dr. Edwards' %}instructor-post{% else %}student-post{% endif %}">
                    {% if page.extra.image %}
                        <img src="{{ page.extra.image }}" alt="Featured image for {{ page.title }}" class="blog-card-image">
                    {% endif %}
                    
                    <div class="blog-card-content">
                        <h3 class="blog-card-title">
                            <a href="{{ page.permalink }}">{{ page.title }}</a>
                        </h3>
                        
                        <div class="blog-card-meta">
                            <span class="blog-card-author">{{ page.extra.author | default(value="Anonymous") }}</span>
                            <span class="blog-card-date">{{ page.date | date(format="%B %d, %Y") }}</span>
                        </div>
                        
                        {% if page.description %}
                            <p class="blog-card-description">{{ page.description }}</p>
                        {% endif %}
                        
                        {% if page.taxonomies and page.taxonomies.tags %}
                            <div class="blog-card-tags">
                                {% for tag in page.taxonomies.tags %}
                                    <a href="{{ get_taxonomy_url(kind='tags', name=tag) }}" class="blog-tag">{{ tag }}</a>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </article>
            {% endfor %}
        </div>
    </div>
    
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="element-callout earth-theme">
            <div class="element-content">
                <h3>About {{ term.name }}</h3>
                <p>These posts explore the concept of {{ term.name }} in relation to digital infrastructure and climate crisis.</p>
                
                <div class="taxonomy-stats">
                    <div class="stat-item">
                        <span class="stat-value">{{ term.pages | length }}</span>
                        <span class="stat-label">Posts</span>
                    </div>
                    
                    <div class="stat-item">
                        {% set authors = [] %}
                        {% for page in term.pages %}
                            {% if page.extra.author %}
                                {% set authors = authors | concat(with=[page.extra.author]) | unique %}
                            {% endif %}
                        {% endfor %}
                        <span class="stat-value">{{ authors | length }}</span>
                        <span class="stat-label">Contributors</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="element-callout fire-theme">
            <div class="element-content">
                <h3>Return to Blog</h3>
                <p>Browse all posts in our class blog.</p>
                <a href="/blog" class="element-link">All Posts →</a>
            </div>
        </div>
    </aside>
</div>

<!-- PAGINATION -->
{% if paginator and paginator.pages > 1 %}
<div class="pagination">
    {% if paginator.previous %}
        <a href="{{ paginator.previous }}" class="pagination-prev">← Previous</a>
    {% endif %}
    
    <span class="pagination-current">Page {{ paginator.current_index }} of {{ paginator.pages }}</span>
    
    {% if paginator.next %}
        <a href="{{ paginator.next }}" class="pagination-next">Next →</a>
    {% endif %}
</div>
{% endif %}
{% endblock content %}